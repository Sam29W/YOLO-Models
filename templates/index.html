<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YOLO Object Detection</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <h1>üéØ YOLO Object Detection System</h1>
        <p>Upload an image to detect objects</p>

        {% if error %}
        <div class="error-box">
            ‚ö†Ô∏è {{ error }}
        </div>
        {% endif %}

        <form action="/detect" method="POST" enctype="multipart/form-data" id="uploadForm">
            <div class="upload-box">
                <input type="file" name="file" id="fileInput" accept="image/*" required onchange="previewImage(event)">
            </div>

            <!-- NEW: Image Preview -->
            <div id="imagePreview" style="display: none;">
                <h3>Preview:</h3>
                <img id="preview" src="" alt="Preview" style="max-width: 400px; border-radius: 10px; margin: 20px auto; display: block;">
            </div>

            <div class="confidence-slider">
                <label>Confidence Threshold: <span id="conf-value">0.5</span></label>
                <input type="range" name="confidence" min="0.3" max="0.9" step="0.1" value="0.5"
                       onchange="document.getElementById('conf-value').textContent = this.value">
            </div>

            <button type="submit" id="detectBtn">üîç Detect Objects</button>

            <!-- NEW: Loading Animation -->
            <div id="loading" style="display: none;">
                <div class="loader"></div>
                <p>ü§ñ AI is analyzing your image... This may take 30-60 seconds on free tier!</p>
            </div>
        </form>

        <footer>
            <p>Built by Samith Shivakumar | Powered by YOLO11</p>
        </footer>
    </div>

    <!-- NEW: JavaScript for Preview and Loading -->
    <script>
        function previewImage(event) {
            const preview = document.getElementById('preview');
            const previewDiv = document.getElementById('imagePreview');
            const file = event.target.files[0];

            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    preview.src = e.target.result;
                    previewDiv.style.display = 'block';
                }
                reader.readAsDataURL(file);
            }
        }

        document.getElementById('uploadForm').onsubmit = function() {
            document.getElementById('loading').style.display = 'block';
            document.getElementById('detectBtn').disabled = true;
            document.getElementById('detectBtn').textContent = '‚è≥ Processing...';
        }
    </script>
</body>
</html>
